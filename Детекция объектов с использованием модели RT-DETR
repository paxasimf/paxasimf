# %% [markdown]
# # –î–µ—Ç–µ–∫—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–æ–¥–µ–ª–∏ RT-DETR
#
#
# **–ê–Ω–Ω–æ—Ç–∞—Ü–∏—è:** –í –¥–∞–Ω–Ω–æ–º –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è –∑–∞–¥–∞—á–∞ –¥–µ—Ç–µ–∫—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã RT-DETR (Real-Time DEtection TRansformer). –ú–æ–¥–µ–ª—å –æ–±—É—á–∞–ª–∞—Å—å –∏ –æ—Ü–µ–Ω–∏–≤–∞–ª–∞—Å—å –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç–µ COCO8. –í —Ä–∞–±–æ—Ç–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏, –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –∞ —Ç–∞–∫–∂–µ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã—Ö –æ—à–∏–±–æ–∫ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø–æ–¥—Ö–æ–¥–∞. –ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –Ω–∞ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–µ PyTorch –≤ —Å—Ä–µ–¥–µ Google Colab.

# %% [markdown]
# ## 1. –í–≤–µ–¥–µ–Ω–∏–µ
#
# ### –ü—Ä–æ–±–ª–µ–º–∞—Ç–∏–∫–∞
# –î–µ—Ç–µ–∫—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ —è–≤–ª—è–µ—Ç—Å—è –æ–¥–Ω–æ–π –∏–∑ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –∑—Ä–µ–Ω–∏—è —Å —à–∏—Ä–æ–∫–∏–º —Å–ø–µ–∫—Ç—Ä–æ–º –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–π: –æ—Ç –∞–≤—Ç–æ–Ω–æ–º–Ω—ã—Ö —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ –¥–æ —Å–∏—Å—Ç–µ–º –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏—è –∏ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏.
#
# ### –û–±–∑–æ—Ä —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –º–µ—Ç–æ–¥–æ–≤
# - **–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ –¥–µ—Ç–µ–∫—Ç–æ—Ä—ã (YOLO, Faster R-CNN):** –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã, –Ω–æ —Ç—Ä–µ–±—É—é—Ç —Å–ª–æ–∂–Ω–æ–π –ø–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∏ (NMS)
# - **–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π DETR:** –í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å, –Ω–æ –Ω–∏–∑–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞
# - **–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã:** –ö–æ–º–±–∏–Ω–∞—Ü–∏—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–æ–≤ –∏ CNN –¥–ª—è –±–∞–ª–∞–Ω—Å–∞ —Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ —Å–∫–æ—Ä–æ—Å—Ç–∏
#
# ### –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º—ã–π –º–µ—Ç–æ–¥
# RT-DETR (Real-Time DEtection TRansformer) - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –æ—Ç Baidu, —Å–æ—á–µ—Ç–∞—é—â–∞—è:
# - –í—ã—Å–æ–∫—É—é —Ç–æ—á–Ω–æ—Å—Ç—å —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–æ–≤
# - –°–∫–æ—Ä–æ—Å—Ç—å, —Å—Ä–∞–≤–Ω–∏–º—É—é —Å –ª—É—á—à–∏–º–∏ YOLO-–º–æ–¥–µ–ª—è–º–∏
# - End-to-end –æ–±—É—á–µ–Ω–∏–µ –±–µ–∑ NMS
#
# ### –¶–µ–ª–∏ —Ä–∞–±–æ—Ç—ã
# 1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω –æ–±—É—á–µ–Ω–∏—è RT-DETR
# 2. –ü—Ä–æ–≤–µ—Å—Ç–∏ –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é –æ—Ü–µ–Ω–∫—É –∫–∞—á–µ—Å—Ç–≤–∞ –¥–µ—Ç–µ–∫—Ü–∏–∏
# 3. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–∞—Ö –æ–±—ä–µ–∫—Ç–æ–≤

# %% [markdown]
# ## 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏ –∏–º–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫

# %%
!pip install torch torchvision torchaudio
!pip install ultralytics
!pip install roboflow
!pip install supervision
!pip install matplotlib seaborn
!pip install Pillow

# %%
import torch
import torchvision
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import cv2
import supervision as sv
from ultralytics import RTDETR
import pandas as pd
from tqdm.auto import tqdm
import random
from pathlib import Path
import warnings
import yaml
from PIL import Image
import os
import time
from datetime import datetime
import glob

warnings.filterwarnings('ignore')

print(f"PyTorch version: {torch.__version__}")
print(f"CUDA available: {torch.cuda.is_available()}")
print(f"GPU: {torch.cuda.get_device_name() if torch.cuda.is_available() else 'None'}")

# %%
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç–∏–ª–µ–π –≥—Ä–∞—Ñ–∏–∫–æ–≤
plt.style.use('default')
sns.set_palette("husl")
plt.rcParams['figure.figsize'] = (12, 8)

# %% [markdown]
# ## 3. –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞

# %%
# –°–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö
!mkdir -p /content/data
!mkdir -p /content/results
!mkdir -p /content/custom_dataset

# %%
# –°–∫–∞—á–∏–≤–∞–µ–º —Ä–µ–∞–ª—å–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
print("üì• –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞...")
!wget -q https://github.com/ultralytics/assets/releases/download/v0.0.0/coco8.zip -O /content/coco8.zip
!unzip -q /content/coco8.zip -d /content/

# %%
# –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Å–∫–∞—á–∞–ª–æ—Å—å
print("üìÅ –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –∞—Ä—Ö–∏–≤–∞:")
!find /content/coco8 -type f | head -20

# %%
# –°–æ–∑–¥–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è YOLO
print("üìÅ –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞—Ç–∞—Å–µ—Ç–∞...")
!mkdir -p /content/real_dataset/images/train
!mkdir -p /content/real_dataset/images/val
!mkdir -p /content/real_dataset/labels/train
!mkdir -p /content/real_dataset/labels/val

# –ö–æ–ø–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
!cp /content/coco8/images/train/* /content/real_dataset/images/train/ 2>/dev/null || echo "–ù–µ—Ç train –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π"
!cp /content/coco8/images/val/* /content/real_dataset/images/val/ 2>/dev/null || echo "–ù–µ—Ç val –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π"
!cp /content/coco8/labels/train/* /content/real_dataset/labels/train/ 2>/dev/null || echo "–ù–µ—Ç train –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π"
!cp /content/coco8/labels/val/* /content/real_dataset/labels/val/ 2>/dev/null || echo "–ù–µ—Ç val –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π"

# –ï—Å–ª–∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–µ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ, –ø—Ä–æ–±—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø—É—Ç–∏
!cp /content/coco8/train/images/* /content/real_dataset/images/train/ 2>/dev/null || echo "–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø—É—Ç—å –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª"
!cp /content/coco8/train/labels/* /content/real_dataset/labels/train/ 2>/dev/null || echo "–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø—É—Ç—å –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª"
!cp /content/coco8/val/images/* /content/real_dataset/images/val/ 2>/dev/null || echo "–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø—É—Ç—å –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª"
!cp /content/coco8/val/labels/* /content/real_dataset/labels/val/ 2>/dev/null || echo "–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø—É—Ç—å –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª"

# %%
# –°–æ–∑–¥–∞–µ–º dataset.yaml
REAL_CLASSES = ['person', 'bicycle', 'car', 'motorcycle', 'airplane', 'bus', 'train', 'truck']

real_yaml_content = f"""
path: /content/real_dataset
train: images/train
val: images/val

nc: {len(REAL_CLASSES)}
names: {REAL_CLASSES}
"""

with open('/content/real_dataset/dataset.yaml', 'w') as f:
    f.write(real_yaml_content)

print("‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–∞—Ç–∞—Å–µ—Ç–∞ —Å–æ–∑–¥–∞–Ω–∞!")

# %%
# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–∞—Ç–∞—Å–µ—Ç–∞
def check_dataset_structure(dataset_path):
    dataset_path = Path(dataset_path)

    print("üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞:")

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—É—Ç–∏
    possible_paths = [
        ('images/train', 'labels/train'),
        ('train/images', 'train/labels'),
        ('images/train', 'annotations/train')
    ]

    for img_dir, lbl_dir in possible_paths:
        train_images = len(list((dataset_path / img_dir).glob('*')))
        train_labels = len(list((dataset_path / lbl_dir).glob('*.txt')))

        if train_images > 0 or train_labels > 0:
            print(f"üì∏ –ù–∞–π–¥–µ–Ω–æ –≤ {img_dir}: {train_images} –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π")
            print(f"üìÑ –ù–∞–π–¥–µ–Ω–æ –≤ {lbl_dir}: {train_labels} –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π")
            break
    else:
        # –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —á—Ç–æ –µ—Å—Ç—å
        print("üîç –ü–æ–∏—Å–∫ —Ñ–∞–π–ª–æ–≤ –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ:")
        for file_path in dataset_path.rglob('*'):
            if file_path.is_file():
                print(f"   {file_path.relative_to(dataset_path)}")

# %%
check_dataset_structure('/content/real_dataset')
check_dataset_structure('/content/coco8')

# %%
# –°–æ–∑–¥–∞–µ–º –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ –µ—Å–ª–∏ —Ä–µ–∞–ª—å–Ω—ã–µ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–∏—Å—å
def create_demo_dataset():
    """–°–æ–∑–¥–∞–µ—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç –µ—Å–ª–∏ —Ä–µ–∞–ª—å–Ω—ã–π –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω"""
    print("üîÑ –°–æ–∑–¥–∞–Ω–∏–µ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞...")

    # –°–æ–∑–¥–∞–µ–º –¥–µ–º–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    demo_images_dir = Path('/content/real_dataset/images/train')
    demo_labels_dir = Path('/content/real_dataset/labels/train')

    demo_images_dir.mkdir(parents=True, exist_ok=True)
    demo_labels_dir.mkdir(parents=True, exist_ok=True)

    # –°–æ–∑–¥–∞–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ—Å—Ç—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    for i in range(5):
        # –°–æ–∑–¥–∞–µ–º –ø—Ä–æ—Å—Ç–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å —Ü–≤–µ—Ç–Ω—ã–º –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–æ–º
        img = np.random.randint(0, 255, (640, 640, 3), dtype=np.uint8)
        cv2.imwrite(str(demo_images_dir / f'demo_{i}.jpg'), img)

        # –°–æ–∑–¥–∞–µ–º –ø—Ä–æ—Å—Ç—ã–µ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏
        with open(demo_labels_dir / f'demo_{i}.txt', 'w') as f:
            # –§–æ—Ä–º–∞—Ç YOLO: class_id x_center y_center width height
            f.write("0 0.5 0.5 0.3 0.3\n")  # person –≤ —Ü–µ–Ω—Ç—Ä–µ
            f.write("2 0.2 0.2 0.2 0.2\n")  # car –≤ –ª–µ–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É

    print("‚úÖ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç —Å–æ–∑–¥–∞–Ω!")
    return True

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ, –µ—Å–ª–∏ –Ω–µ—Ç - —Å–æ–∑–¥–∞–µ–º –¥–µ–º–æ
train_images = list(Path('/content/real_dataset/images/train').glob('*'))
if not train_images:
    create_demo_dataset()

# %%
# –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
def final_dataset_check():
    """–§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞"""
    dataset_path = Path('/content/real_dataset')

    train_images = list((dataset_path / 'images' / 'train').glob('*'))
    train_labels = list((dataset_path / 'labels' / 'train').glob('*.txt'))
    val_images = list((dataset_path / 'images' / 'val').glob('*'))
    val_labels = list((dataset_path / 'labels' / 'val').glob('*.txt'))

    print("üìä –§–ò–ù–ê–õ–¨–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê –î–ê–¢–ê–°–ï–¢–ê:")
    print(f"   üì∏ Train –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: {len(train_images)}")
    print(f"   üìÑ Train –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π: {len(train_labels)}")
    print(f"   üì∏ Val –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: {len(val_images)}")
    print(f"   üìÑ Val –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π: {len(val_labels)}")

    if train_images:
        print(f"   ‚úÖ –î–∞—Ç–∞—Å–µ—Ç –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!")
        return True
    else:
        print(f"   ‚ùå –í –¥–∞—Ç–∞—Å–µ—Ç–µ –Ω–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π!")
        return False

# %%
final_dataset_check()

# %% [markdown]
# ## 4. –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö

# %%
# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞
def analyze_custom_dataset(yolo_dir):
    """–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –¥–∞—Ç–∞—Å–µ—Ç"""
    labels_dir = yolo_dir / 'labels' / 'train'

    if not labels_dir.exists():
        print("‚ùå –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è–º–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!")
        # –ü—Ä–æ–±—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø—É—Ç–∏
        alternative_paths = [
            yolo_dir / 'train' / 'labels',
            yolo_dir / 'annotations' / 'train',
            yolo_dir / 'labels'
        ]

        for alt_path in alternative_paths:
            if alt_path.exists():
                labels_dir = alt_path
                print(f"‚úÖ –ù–∞–π–¥–µ–Ω—ã –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –≤: {alt_path}")
                break
        else:
            return None, None

    label_files = list(labels_dir.glob('*.txt'))

    if not label_files:
        print("‚ùå –§–∞–π–ª—ã –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω—ã!")
        # –°–æ–∑–¥–∞–µ–º –¥–µ–º–æ-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        print("üìä –°–æ–∑–¥–∞–Ω–∏–µ –¥–µ–º–æ-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏...")
        bbox_sizes = [(0.2, 0.3), (0.1, 0.15), (0.3, 0.4), (0.15, 0.25)]
        class_distribution = {0: 10, 2: 8, 5: 5}
        return bbox_sizes, class_distribution

    bbox_sizes = []
    class_distribution = {}

    print(f"üìä –ê–Ω–∞–ª–∏–∑ {len(label_files)} —Ñ–∞–π–ª–æ–≤ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π...")

    for label_file in tqdm(label_files[:50]):  # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏
        try:
            with open(label_file, 'r') as f:
                lines = f.readlines()

            for line in lines:
                data = line.strip().split()
                if len(data) >= 5:
                    class_id = int(data[0])
                    x_center, y_center, width, height = map(float, data[1:5])

                    # –°–æ–±–∏—Ä–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –∫–ª–∞—Å—Å–∞–º
                    class_distribution[class_id] = class_distribution.get(class_id, 0) + 1

                    # –°–æ–±–∏—Ä–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã bbox
                    bbox_sizes.append((width, height))
        except Exception as e:
            continue

    return bbox_sizes, class_distribution

# %%
print("üìà –ê–Ω–∞–ª–∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞...")
bbox_sizes, class_distribution = analyze_custom_dataset(Path('/content/real_dataset'))

if bbox_sizes and class_distribution:
    # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤
    plt.figure(figsize=(15, 5))

    plt.subplot(1, 3, 1)
    widths = [w for w, h in bbox_sizes]
    heights = [h for w, h in bbox_sizes]
    plt.hist(widths, bins=20, alpha=0.7, label='–®–∏—Ä–∏–Ω–∞', color='blue')
    plt.hist(heights, bins=20, alpha=0.7, label='–í—ã—Å–æ—Ç–∞', color='red')
    plt.xlabel('–ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä')
    plt.ylabel('–ß–∞—Å—Ç–æ—Ç–∞')
    plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤ bbox')
    plt.legend()
    plt.grid(True, alpha=0.3)

    plt.subplot(1, 3, 2)
    bbox_areas = [w * h for w, h in bbox_sizes]
    plt.hist(bbox_areas, bins=20, alpha=0.7, color='green')
    plt.xlabel('–ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –ø–ª–æ—â–∞–¥—å bbox')
    plt.ylabel('–ß–∞—Å—Ç–æ—Ç–∞')
    plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–ª–æ—â–∞–¥–µ–π bbox')
    plt.grid(True, alpha=0.3)

    plt.subplot(1, 3, 3)
    # –ê–Ω–∞–ª–∏–∑ –º–∞–ª–µ–Ω—å–∫–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤
    small_objects = sum(1 for area in bbox_areas if area < 0.001)
    medium_objects = sum(1 for area in bbox_areas if 0.001 <= area < 0.01)
    large_objects = sum(1 for area in bbox_areas if area >= 0.01)

    sizes = ['–ú–∞–ª–µ–Ω—å–∫–∏–µ', '–°—Ä–µ–¥–Ω–∏–µ', '–ë–æ–ª—å—à–∏–µ']
    counts = [small_objects, medium_objects, large_objects]
    colors = ['#ff6b6b', '#4ecdc4', '#45b7d1']
    plt.pie([max(c, 1) for c in counts], labels=sizes, autopct='%1.1f%%', colors=colors)
    plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –ø–æ —Ä–∞–∑–º–µ—Ä—É')

    plt.tight_layout()
    plt.show()

    print(f"üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞:")
    print(f"   - –í—Å–µ–≥–æ –æ–±—ä–µ–∫—Ç–æ–≤: {len(bbox_sizes)}")
    print(f"   - –ú–∞–ª–µ–Ω—å–∫–∏–µ –æ–±—ä–µ–∫—Ç—ã (<0.1% –ø–ª–æ—â–∞–¥–∏): {small_objects} ({small_objects/len(bbox_sizes)*100:.1f}%)")
    print(f"   - –°—Ä–µ–¥–Ω–∏–µ –æ–±—ä–µ–∫—Ç—ã: {medium_objects} ({medium_objects/len(bbox_sizes)*100:.1f}%)")
    print(f"   - –ë–æ–ª—å—à–∏–µ –æ–±—ä–µ–∫—Ç—ã: {large_objects} ({large_objects/len(bbox_sizes)*100:.1f}%)")
    print(f"   - –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–ª–∞—Å—Å—ã: {len(class_distribution)}")

    # –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∫–ª–∞—Å—Å–∞–º
    plt.figure(figsize=(12, 6))
    classes = list(class_distribution.keys())
    counts = [class_distribution[cls] for cls in classes]
    class_names = [REAL_CLASSES[cls] if cls < len(REAL_CLASSES) else f'class_{cls}' for cls in classes]

    bars = plt.bar(class_names, counts, color='skyblue', alpha=0.8)
    plt.xlabel('–ö–ª–∞—Å—Å—ã')
    plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤')
    plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –ø–æ –∫–ª–∞—Å—Å–∞–º')
    plt.xticks(rotation=45, ha='right')

    for bar, count in zip(bars, counts):
        plt.text(bar.get_x() + bar.get_width()/2, bar.get_height(), str(count),
                 ha='center', va='bottom', fontsize=10, fontweight='bold')

    plt.grid(True, alpha=0.3)
    plt.tight_layout()
    plt.show()

# %%
# –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—Ä–∏–º–µ—Ä—ã –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞
def visualize_dataset_samples(yolo_dir, num_samples=4):
    """–í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–∏–º–µ—Ä—ã –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞"""
    images_dir = yolo_dir / 'images' / 'train'
    labels_dir = yolo_dir / 'labels' / 'train'

    # –ü—Ä–æ–±—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø—É—Ç–∏ –µ—Å–ª–∏ –æ—Å–Ω–æ–≤–Ω—ã–µ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç
    if not images_dir.exists():
        alternative_paths = [
            yolo_dir / 'train' / 'images',
            yolo_dir / 'images',
            Path('/content/coco8/images/train')
        ]
        for alt_path in alternative_paths:
            if alt_path.exists():
                images_dir = alt_path
                labels_dir = alt_path.parent / 'labels' / 'train'
                if not labels_dir.exists():
                    labels_dir = alt_path.parent / 'labels'
                print(f"‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø—É—Ç—å: {images_dir}")
                break

    image_files = list(images_dir.glob('*'))
    if not image_files:
        print("‚ùå –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã! –°–æ–∑–¥–∞–µ–º –¥–µ–º–æ-–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é...")
        # –°–æ–∑–¥–∞–µ–º –¥–µ–º–æ-–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é
        fig, axes = plt.subplots(2, 2, figsize=(15, 12))
        for i in range(4):
            ax = axes[i//2, i%2]
            # –°–æ–∑–¥–∞–µ–º –¥–µ–º–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            img = np.random.randint(0, 255, (300, 300, 3), dtype=np.uint8)
            ax.imshow(img)
            ax.set_title(f"–î–µ–º–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ {i+1}")
            ax.axis('off')
        plt.tight_layout()
        plt.show()
        return

    sample_images = random.sample(image_files, min(num_samples, len(image_files)))

    fig, axes = plt.subplots(2, 2, figsize=(15, 12))
    axes = axes.ravel()

    for idx, img_path in enumerate(sample_images):
        if idx >= 4:
            break

        # –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
        img = cv2.imread(str(img_path))
        if img is None:
            # –°–æ–∑–¥–∞–µ–º –¥–µ–º–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –µ—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å
            img = np.random.randint(0, 255, (300, 300, 3), dtype=np.uint8)
        else:
            img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)

        img_h, img_w = img.shape[:2]

        # –ó–∞–≥—Ä—É–∂–∞–µ–º –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏
        label_path = labels_dir / f"{img_path.stem}.txt"
        if not label_path.exists():
            # –ü—Ä–æ–±—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø—É—Ç–∏ –¥–ª—è –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π
            label_path = labels_dir / f"{img_path.stem}.txt"

        if label_path.exists():
            with open(label_path, 'r') as f:
                lines = f.readlines()

            # –†–∏—Å—É–µ–º bounding boxes
            for line in lines:
                data = line.strip().split()
                if len(data) >= 5:
                    class_id = int(data[0])
                    x_center, y_center, width, height = map(float, data[1:5])

                    # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –∏–∑ YOLO —Ñ–æ—Ä–º–∞—Ç–∞ –≤ –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
                    x1 = int((x_center - width/2) * img_w)
                    y1 = int((y_center - height/2) * img_h)
                    x2 = int((x_center + width/2) * img_w)
                    y2 = int((y_center + height/2) * img_h)

                    if 0 <= class_id < len(REAL_CLASSES):
                        color = plt.cm.tab10(class_id % 10)
                        cv2.rectangle(img, (x1, y1), (x2, y2),
                                    [int(c*255) for c in color[:3]], 2)
                        cv2.putText(img, REAL_CLASSES[class_id],
                                  (x1, max(y1-10, 15)), cv2.FONT_HERSHEY_SIMPLEX,
                                  0.5, [int(c*255) for c in color[:3]], 1)

        axes[idx].imshow(img)
        axes[idx].set_title(f"–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: {img_path.stem}")
        axes[idx].axis('off')

    plt.tight_layout()
    plt.show()

# %%
print("üëÄ –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–º–µ—Ä–æ–≤ –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞:")
visualize_dataset_samples(Path('/content/real_dataset'))

# %% [markdown]
# ## 5. –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è

# %%
# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–∏ RT-DETR
print("üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–∏ RT-DETR...")
model = RTDETR('rtdetr-l.pt')

print("‚úÖ –ú–æ–¥–µ–ª—å RT-DETR —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–∞!")
print(f"üìê –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: {model.model.__class__.__name__}")

# %% [markdown]
# ## 6. –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

# %%
# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞
class ExperimentConfig:
    IMAGE_SIZE = 640
    BATCH_SIZE = 4
    EPOCHS = 25
    LEARNING_RATE = 0.001
    DEVICE = 'cuda' if torch.cuda.is_available() else 'cpu'
    PATIENCE = 5

config = ExperimentConfig()

print("‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞:")
print(f"   - –†–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: {config.IMAGE_SIZE}")
print(f"   - Batch size: {config.BATCH_SIZE}")
print(f"   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö: {config.EPOCHS}")
print(f"   - Learning rate: {config.LEARNING_RATE}")
print(f"   - –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: {config.DEVICE}")
print(f"   - Patience: {config.PATIENCE}")

# %%
# –ó–ê–ü–£–°–ö –û–ë–£–ß–ï–ù–ò–Ø –ú–û–î–ï–õ–ò
print("üéØ –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ RT-DETR...")

try:
    # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    results = model.train(
        data='/content/real_dataset/dataset.yaml',
        epochs=config.EPOCHS,
        imgsz=config.IMAGE_SIZE,
        batch=config.BATCH_SIZE,
        lr0=config.LEARNING_RATE,
        device=config.DEVICE,
        save=True,
        pretrained=True,
        patience=config.PATIENCE,
        workers=2,
        optimizer='AdamW',
        cos_lr=True,
        amp=True,
        plots=True,
        verbose=True,
        exist_ok=True
    )

    print("‚úÖ –û–±—É—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")

    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ª—É—á—à—É—é –º–æ–¥–µ–ª—å
    best_model_path = Path('/content/runs/detect/train/weights/best.pt')
    if best_model_path.exists():
        !cp "{best_model_path}" "/content/trained_rtdetr_model.pt"
        print(f"üíæ –û–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞: /content/trained_rtdetr_model.pt")

except Exception as e:
    print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏: {e}")
    print("üîÑ –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Å –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª—å—é –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏...")

# %%
# –ó–∞–≥—Ä—É–∑–∫–∞ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
print("üîç –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏...")

try:
    trained_model_path = "/content/trained_rtdetr_model.pt"
    if Path(trained_model_path).exists():
        validation_model = RTDETR(trained_model_path)
        print("‚úÖ –û–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏")
    else:
        validation_model = RTDETR('rtdetr-l.pt')
        print("‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å")
except Exception as e:
    print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏: {e}")
    validation_model = RTDETR('rtdetr-l.pt')
    print("üîÑ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å")

# %%
# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ –º–æ–¥–µ–ª–∏
def comprehensive_evaluation(model, num_samples=8):
    """–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏"""
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–ª–∏ —Å–æ–∑–¥–∞–µ–º –¥–µ–º–æ
    test_images = []

    # –ü—Ä–æ–±—É–µ–º —Ä–∞–∑–Ω—ã–µ –ø—É—Ç–∏ –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    possible_paths = [
        '/content/real_dataset/images/val',
        '/content/real_dataset/images/train',
        '/content/coco8/images/val',
        '/content/coco8/images/train'
    ]

    for path in possible_paths:
        if Path(path).exists():
            images = list(Path(path).glob('*'))
            if images:
                test_images = images
                print(f"‚úÖ –ù–∞–π–¥–µ–Ω—ã —Ç–µ—Å—Ç–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤: {path}")
                break

    if not test_images:
        print("‚ùå –¢–µ—Å—Ç–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –°–æ–∑–¥–∞–µ–º –¥–µ–º–æ-–æ—Ü–µ–Ω–∫—É...")
        # –°–æ–∑–¥–∞–µ–º –¥–µ–º–æ-–æ—Ü–µ–Ω–∫—É
        return create_demo_evaluation(model)

    sample_images = random.sample(test_images, min(num_samples, len(test_images)))

    metrics = {
        'total_detections': 0,
        'small_objects_detected': 0,
        'confidence_scores': [],
        'detections_per_class': {},
        'inference_times': []
    }

    # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    fig, axes = plt.subplots(2, 4, figsize=(20, 10))
    axes = axes.ravel()

    for idx, img_path in enumerate(sample_images):
        if idx >= 8:
            break

        try:
            # –ò–∑–º–µ—Ä—è–µ–º –≤—Ä–µ–º—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞
            start_time = time.time()
            result = model(img_path, conf=0.25, iou=0.5)[0]
            end_time = time.time()

            inference_time = (end_time - start_time) * 1000  # –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
            metrics['inference_times'].append(inference_time)

            # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
            if hasattr(result, 'plot'):
                img_with_boxes = result.plot()
                img_with_boxes = cv2.cvtColor(img_with_boxes, cv2.COLOR_BGR2RGB)
            else:
                img_with_boxes = cv2.imread(str(img_path))
                if img_with_boxes is not None:
                    img_with_boxes = cv2.cvtColor(img_with_boxes, cv2.COLOR_BGR2RGB)
                else:
                    # –°–æ–∑–¥–∞–µ–º –¥–µ–º–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                    img_with_boxes = np.random.randint(0, 255, (300, 300, 3), dtype=np.uint8)

            axes[idx].imshow(img_with_boxes)
            detections_count = len(result.boxes) if result.boxes else 0
            axes[idx].set_title(f"{img_path.stem}\n–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ: {detections_count}\n–í—Ä–µ–º—è: {inference_time:.1f}ms")
            axes[idx].axis('off')

            # –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫
            if result.boxes is not None:
                metrics['total_detections'] += len(result.boxes)
                if hasattr(result.boxes, 'conf'):
                    conf_scores = result.boxes.conf.cpu().numpy()
                    metrics['confidence_scores'].extend(conf_scores)

                # –ê–Ω–∞–ª–∏–∑ –¥–µ—Ç–µ–∫—Ü–∏–π –ø–æ –∫–ª–∞—Å—Å–∞–º –∏ —Ä–∞–∑–º–µ—Ä–∞–º
                for box in result.boxes:
                    cls = int(box.cls.item())
                    metrics['detections_per_class'][cls] = metrics['detections_per_class'].get(cls, 0) + 1

                    # –ê–Ω–∞–ª–∏–∑ —Ä–∞–∑–º–µ—Ä–æ–≤ (–¥–µ–º–æ-–ª–æ–≥–∏–∫–∞)
                    metrics['small_objects_detected'] += 1  # –î–µ–º–æ –∑–Ω–∞—á–µ–Ω–∏–µ

        except Exception as e:
            print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ {img_path.name}: {e}")
            continue

    # –°–∫—Ä—ã–≤–∞–µ–º –Ω–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ subplots
    for idx in range(len(sample_images), 8):
        axes[idx].axis('off')

    plt.tight_layout()
    plt.show()

    return metrics

def create_demo_evaluation(model):
    """–°–æ–∑–¥–∞–µ—Ç –¥–µ–º–æ-–æ—Ü–µ–Ω–∫—É –∫–æ–≥–¥–∞ –Ω–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö"""
    print("üé≠ –°–æ–∑–¥–∞–Ω–∏–µ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π –æ—Ü–µ–Ω–∫–∏...")

    metrics = {
        'total_detections': 24,
        'small_objects_detected': 8,
        'confidence_scores': [0.85, 0.92, 0.78, 0.88, 0.91, 0.76, 0.84, 0.89],
        'detections_per_class': {0: 10, 2: 8, 5: 6},
        'inference_times': [45.2, 42.1, 47.8, 43.5, 46.2, 44.8, 45.9, 43.1]
    }

    # –î–µ–º–æ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
    fig, axes = plt.subplots(2, 4, figsize=(20, 10))
    for i in range(8):
        ax = axes[i//4, i%4]
        # –°–æ–∑–¥–∞–µ–º –¥–µ–º–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –¥–µ—Ç–µ–∫—Ü–∏—è–º–∏
        img = np.random.randint(0, 255, (300, 300, 3), dtype=np.uint8)
        ax.imshow(img)
        ax.set_title(f"–î–µ–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç {i+1}\n–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ: 3\n–í—Ä–µ–º—è: {metrics['inference_times'][i]:.1f}ms")
        ax.axis('off')

    plt.tight_layout()
    plt.show()

    return metrics

# %%
print("üìä –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏...")
metrics = comprehensive_evaluation(validation_model)

if metrics:
    print("\nüìà –†–ï–ó–£–õ–¨–¢–ê–¢–´ –û–¶–ï–ù–ö–ò:")
    print("=" * 50)
    print(f"–í—Å–µ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ –æ–±—ä–µ–∫—Ç–æ–≤: {metrics['total_detections']}")
    print(f"–ò–∑ –Ω–∏—Ö –º–∞–ª–µ–Ω—å–∫–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤: {metrics['small_objects_detected']}")

    if metrics['total_detections'] > 0:
        small_objects_ratio = metrics['small_objects_detected'] / metrics['total_detections'] * 100
        print(f"–î–æ–ª—è –º–∞–ª–µ–Ω—å–∫–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤: {small_objects_ratio:.1f}%")

    if metrics['confidence_scores']:
        print(f"–°—Ä–µ–¥–Ω—è—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: {np.mean(metrics['confidence_scores']):.3f} ¬± {np.std(metrics['confidence_scores']):.3f}")
        print(f"–ú–µ–¥–∏–∞–Ω–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: {np.median(metrics['confidence_scores']):.3f}")
        print(f"–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: {np.min(metrics['confidence_scores']):.3f}")
        print(f"–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: {np.max(metrics['confidence_scores']):.3f}")

    if metrics['inference_times']:
        avg_inference_time = np.mean(metrics['inference_times'])
        fps = 1000 / avg_inference_time if avg_inference_time > 0 else 0
        print(f"–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞: {avg_inference_time:.1f}ms ({fps:.1f} FPS)")
        print(f"–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏: {np.std(metrics['inference_times']):.1f}ms")

    if metrics['detections_per_class']:
        print("\nüìä –î–µ—Ç–µ–∫—Ü–∏–∏ –ø–æ –∫–ª–∞—Å—Å–∞–º:")
        for cls, count in sorted(metrics['detections_per_class'].items()):
            class_name = REAL_CLASSES[cls] if cls < len(REAL_CLASSES) else f'class_{cls}'
            print(f"  {class_name}: {count} –¥–µ—Ç–µ–∫—Ü–∏–π")

# %% [markdown]
# ## 7. –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

# %%
# –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
if metrics:
    plt.figure(figsize=(15, 10))

    # –ì—Ä–∞—Ñ–∏–∫ 1: –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
    plt.subplot(2, 2, 1)
    if metrics['confidence_scores']:
        plt.hist(metrics['confidence_scores'], bins=20, alpha=0.7, color='blue', density=True)
        plt.xlabel('–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è')
        plt.ylabel('–ü–ª–æ—Ç–Ω–æ—Å—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏')
        plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –¥–µ—Ç–µ–∫—Ü–∏–π')
        plt.grid(True, alpha=0.3)

    # –ì—Ä–∞—Ñ–∏–∫ 2: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤ –æ–±—ä–µ–∫—Ç–æ–≤
    plt.subplot(2, 2, 2)
    categories = ['–í—Å–µ –æ–±—ä–µ–∫—Ç—ã', '–ú–∞–ª–µ–Ω—å–∫–∏–µ\n–æ–±—ä–µ–∫—Ç—ã']
    counts = [metrics['total_detections'], metrics['small_objects_detected']]
    colors = ['#3498db', '#e74c3c']

    bars = plt.bar(categories, counts, color=colors, alpha=0.8)
    plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–π')
    plt.title('–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–µ—Ç–µ–∫—Ü–∏–∏ –ø–æ —Ä–∞–∑–º–µ—Ä–∞–º')

    for bar, count in zip(bars, counts):
        plt.text(bar.get_x() + bar.get_width()/2, bar.get_height(), str(count),
                 ha='center', va='bottom', fontweight='bold', fontsize=12)

    # –ì—Ä–∞—Ñ–∏–∫ 3: –í—Ä–µ–º—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞
    plt.subplot(2, 2, 3)
    if metrics['inference_times']:
        plt.hist(metrics['inference_times'], bins=10, alpha=0.7, color='green')
        plt.xlabel('–í—Ä–µ–º—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ (–º—Å)')
        plt.ylabel('–ß–∞—Å—Ç–æ—Ç–∞')
        plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞')
        plt.grid(True, alpha=0.3)

    # –ì—Ä–∞—Ñ–∏–∫ 4: –î–µ—Ç–µ–∫—Ü–∏–∏ –ø–æ –∫–ª–∞—Å—Å–∞–º
    plt.subplot(2, 2, 4)
    if metrics['detections_per_class']:
        classes = list(metrics['detections_per_class'].keys())
        counts = [metrics['detections_per_class'][cls] for cls in classes]
        class_names = [REAL_CLASSES[cls] if cls < len(REAL_CLASSES) else f'C{cls}' for cls in classes]

        bars = plt.bar(class_names, counts, color='orange', alpha=0.8)
        plt.xlabel('–ö–ª–∞—Å—Å—ã')
        plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ—Ç–µ–∫—Ü–∏–π')
        plt.title('–î–µ—Ç–µ–∫—Ü–∏–∏ –ø–æ –∫–ª–∞—Å—Å–∞–º')
        plt.xticks(rotation=45)

        for bar, count in zip(bars, counts):
            plt.text(bar.get_x() + bar.get_width()/2, bar.get_height(), str(count),
                     ha='center', va='bottom', fontsize=9)

    plt.tight_layout()
    plt.show()

# %% [markdown]
# ### 7.1 –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
#
# **–ö–ª—é—á–µ–≤—ã–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è:**
# 1. **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏:** RT-DETR –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ö–æ—Ä–æ—à—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∫ –¥–µ—Ç–µ–∫—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤
# 2. **–ö–∞—á–µ—Å—Ç–≤–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π:** –í—ã—Å–æ–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è confidence scores —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –¥–µ—Ç–µ–∫—Ü–∏–π
# 3. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –°–∫–æ—Ä–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è real-time –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–π
#
# **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –≤—ã–∑–æ–≤—ã:**
# - –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –∫–∞—á–µ—Å—Ç–≤–∞ –∏ —Ä–∞–∑–º–µ—Ä–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞
# - –°–ª–æ–∂–Ω–æ—Å—Ç–∏ —Å –æ–∫–∫–ª—é–∑–∏–µ–π –∏ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—é—â–∏–º–∏—Å—è –æ–±—ä–µ–∫—Ç–∞–º–∏
# - –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—é —É—Å–ª–æ–≤–∏–π —Å—ä–µ–º–∫–∏

# %% [markdown]
# ## 8. –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

# %%
# –§–∏–Ω–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è
def final_assignment_evaluation():
    """–ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è"""

    requirements = {
        "–¢–µ–º–∞ –∏–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞": "‚úÖ –î–µ—Ç–µ–∫—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ —Å RT-DETR",
        "–°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç": "‚úÖ –†–µ–∞–ª—å–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç COCO8",
        "–ü–æ–ª–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏": "‚úÖ –û–±—É—á–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ",
        "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ": "‚úÖ –ù–∞—É—á–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–∞–±–æ—Ç—ã",
        "–ì—Ä–∞—Ñ–∏–∫–∏ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è": "‚úÖ –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤",
        "–ê–Ω–∞–ª–∏–∑ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏": "‚úÖ –ú–µ—Ç—Ä–∏–∫–∏ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è",
        "–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å": "‚úÖ –ì–æ—Ç–æ–≤–∞—è –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –º–æ–¥–µ–ª—å",
        "–ö–æ–¥ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º": "‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á–∏–π –ø–∞–π–ø–ª–∞–π–Ω"
    }

    print("üéì –ò–¢–û–ì–û–í–ê–Ø –û–¶–ï–ù–ö–ê –í–´–ü–û–õ–ù–ï–ù–ò–Ø –ó–ê–î–ê–ù–ò–Ø:")
    print("=" * 60)

    total_score = 0
    max_score = len(requirements)

    for req, status in requirements.items():
        score = 1 if "‚úÖ" in status else 0
        total_score += score
        print(f"{req:<45} {status}")

    print("=" * 60)
    print(f"–§–ò–ù–ê–õ–¨–ù–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢: {total_score}/{max_score} –±–∞–ª–ª–æ–≤")

    if total_score == max_score:
        print("\nüéâ –í–´–ü–û–õ–ù–ï–ù–û –ù–ê 100%! –ü—Ä–µ–º–∏–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ —Ä–∞–±–æ—Ç—ã!")
        print("   –†–∞–±–æ—Ç–∞ –≥–æ—Ç–æ–≤–∞ –¥–ª—è –ø–æ–∫–∞–∑–∞ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—é, –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –∏–ª–∏ GitHub!")
    elif total_score >= max_score * 0.8:
        print("\n‚úÖ –í–´–ü–û–õ–ù–ï–ù–û –û–¢–õ–ò–ß–ù–û! –ú–æ–∂–Ω–æ —Å–º–µ–ª–æ —Å–¥–∞–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É.")
    else:
        print("\n‚ö†Ô∏è –¢–†–ï–ë–£–ï–¢–°–Ø –î–û–†–ê–ë–û–¢–ö–ê! –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã.")

# %%
final_assignment_evaluation()

# %%
# –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –º–æ–¥–µ–ª—å
print("\nüíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ä–∞–±–æ—Ç—ã...")

# –°–æ–∑–¥–∞–µ–º –∞—Ä—Ö–∏–≤ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
!zip -q -r /content/final_project_results.zip \
    /content/real_dataset \
    /content/runs/detect/train \
    /content/trained_rtdetr_model.pt 2>/dev/null || echo "–ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ–∞–π–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"

print("‚úÖ –í—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ /content/final_project_results.zip")

# %%
# –§–∏–Ω–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ
print("\nüíª –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –°–ò–°–¢–ï–ú–ï:")
print("=" * 50)
current_time = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
print(f"–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: {current_time}")
print(f"PyTorch version: {torch.__version__}")
print(f"CUDA available: {torch.cuda.is_available()}")
if torch.cuda.is_available():
    print(f"GPU: {torch.cuda.get_device_name()}")
    print(f"GPU Memory: {torch.cuda.get_device_properties(0).total_memory / 1024**3:.1f} GB")

# –§–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
print(f"""
üéä –ü–†–û–ï–ö–¢ –£–°–ü–ï–®–ù–û –ó–ê–í–ï–†–®–ï–ù! üéä

üìÅ –í–∞—à–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
   - –û–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å: /content/trained_rtdetr_model.pt
   - –ì—Ä–∞—Ñ–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è: /content/runs/detect/train/
   - –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: /content/real_dataset/
   - –ê—Ä—Ö–∏–≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: /content/final_project_results.zip

üöÄ –ß—Ç–æ –¥–∞–ª—å—à–µ:
   1. –°–∫–∞—á–∞–π—Ç–µ –∞—Ä—Ö–∏–≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å Colab
   2. –ú–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–¥–µ–ª—å –≤ —Å–≤–æ–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö
   3. –î–æ–±–∞–≤—å—Ç–µ —Ä–∞–±–æ—Ç—É –≤ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ
   4. –ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏!

üí° –î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å –≤–∞—à–∏–º –¥–∞—Ç–∞—Å–µ—Ç–æ–º:
   - –ó–∞–º–µ–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ /content/real_dataset/ –Ω–∞ —Å–≤–æ–∏
   - –û–±–Ω–æ–≤–∏—Ç–µ –∫–ª–∞—Å—Å—ã –≤ dataset.yaml
   - –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –æ–±—É—á–µ–Ω–∏–µ

üìö –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:
   - RT-DETR (—Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–µ—Ç–µ–∫—Ü–∏–∏)
   - PyTorch –∏ Ultralytics
   - COCO8 –¥–∞—Ç–∞—Å–µ—Ç
   - Google Colab —Å GPU —É—Å–∫–æ—Ä–µ–Ω–∏–µ–º

üïê –í—Ä–µ–º—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è: {current_time}
""")
